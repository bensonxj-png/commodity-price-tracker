name: æ¯æ—¥ä»·æ ¼æ›´æ–°

on:
  schedule:
    # æ¯å¤©åŒ—äº¬æ—¶é—´ä¸Šåˆ9:00è¿è¡Œ (UTC 1:00)
    - cron: '0 1 * * *'
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  update-prices:
    runs-on: ubuntu-latest

    steps:
    - name: æ£€å‡ºä»£ç 
      uses: actions/checkout@v3

    - name: è®¾ç½®Pythonç¯å¢ƒ
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: å®‰è£…ä¾èµ–
      run: |
        pip install -r requirements.txt

    - name: è¿è¡Œçˆ¬è™«
      run: |
        python commodity_price_scraper.py

    - name: æäº¤æ›´æ–°
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add å•†å“ä»·æ ¼æ•°æ®.xlsx
        git commit -m "ğŸ¤– è‡ªåŠ¨æ›´æ–°ä»·æ ¼æ•°æ® $(date +'%Y-%m-%d')" || echo "æ²¡æœ‰å˜åŒ–"
        git push
